(()=>{var e=document.querySelector('meta[name="base-url"]').getAttribute("content");function t(n,a,i,d,r,o){var s=n.slice(i,d),l=new FormData;l.append("file_chunk",s),l.append("index",a),l.append("total_chunks",Math.ceil(n.size/r)),l.append("file_name",n.name);var c=new XMLHttpRequest;c.upload.addEventListener("progress",(function(e){if(e.lengthComputable){var t=e.loaded/e.total*100;o[a].progressBar.style.width=t+"%"}})),c.open("POST","".concat(e,"/app/filemanagers/upload"),!0),c.setRequestHeader("X-CSRF-TOKEN",document.querySelector('meta[name="csrf-token"]').getAttribute("content")),c.onload=function(){200===c.status&&(JSON.parse(c.responseText).success&&(d<n.size?(i=d,d=Math.min(i+r,n.size),t(n,a,i,d,r,o)):o[a].progressBar.style.width="100%"))},c.send(l)}document.addEventListener("DOMContentLoaded",(function(){var t="",n="",a="",i=0;function d(){document.querySelectorAll('button[data-bs-target="#exampleModal"]').forEach((function(e){!function(e){e.addEventListener("click",(function(){n=this.getAttribute("data-image-container"),a=this.getAttribute("data-hidden-input")}))}(e)}))}function r(e,n){t=e,document.querySelectorAll("#mediaLibraryContent img, #mediaLibraryContent video").forEach((function(e){e.classList.remove("iq-image")})),n.classList.add("iq-image")}function o(e){e.find("select.select2").each((function(){$(this).select2({width:"100%"})}))}document.getElementById("mediaLibraryContent")&&document.getElementById("mediaLibraryContent").addEventListener("click",(function(e){if("IMG"===e.target.tagName)r(e.target.src,e.target);else if("VIDEO"===e.target.tagName){r(e.target.querySelector("source").src,e.target),e.preventDefault()}})),document.getElementById("mediaSubmitButton")&&document.getElementById("mediaSubmitButton").addEventListener("click",(function(){if(t&&n&&a){var e=document.getElementById(n),i=document.getElementById(a);if(e){if(i.value=t,e.innerHTML="",i.hasAttribute("data-validation"))if(t.endsWith(".mp4")||t.endsWith(".avi")){var d=document.createElement("video");d.src=t,d.controls=!0,d.classList.add("img-fluid","mb-2"),d.style.maxWidth="300px",d.style.maxHeight="300px",e.appendChild(d),(r=document.createElement("span")).innerHTML="&times;",r.classList.add("remove-media-icon"),r.style.cursor="pointer",r.style.fontSize="24px",r.style.marginLeft="10px",r.addEventListener("click",(function(){e.innerHTML="",i.value=""})),e.appendChild(r)}else{(s=document.createElement("div")).classList.add("text-danger"),s.textContent="Only video files are allowed.",e.appendChild(s)}else if(t.endsWith(".png")||t.endsWith(".jpg")){var r,o=document.createElement("img");o.src=t,o.classList.add("img-fluid","mb-2"),o.style.maxWidth="100px",o.style.maxHeight="100px",e.appendChild(o),(r=document.createElement("span")).innerHTML="&times;",r.classList.add("remove-media-icon"),r.style.cursor="pointer",r.style.fontSize="24px",r.style.marginLeft="10px",r.addEventListener("click",(function(){e.innerHTML="",i.value=""})),e.appendChild(r)}else{var s;(s=document.createElement("div")).classList.add("text-danger"),s.textContent="Only image files are allowed.",e.appendChild(s)}$("#exampleModal").modal("hide")}}})),document.getElementById("submitButton")&&document.getElementById("submitButton").addEventListener("click",(function(t){t.preventDefault();var n=new FormData,a=window.uploadedFiles.filter((function(e){return!e.removed}));if(a.length>0){for(var i=0;i<a.length;i++)n.append("file_url[]",a[i].file);var d=new XMLHttpRequest;d.open("POST","".concat(e,"/app/filemanagers/store"),!0),d.setRequestHeader("X-CSRF-TOKEN",document.querySelector('meta[name="csrf-token"]').getAttribute("content")),d.onload=function(){200===d.status&&(document.getElementById("nav-media-library-tab").click(),fetch("".concat(e,"/app/filemanagers/getMediaStore")).then((function(e){return e.json()})).then((function(e){var t=document.getElementById("mediaLibraryContent");t.innerHTML="",e.response.forEach((function(e){if(e.endsWith(".mp4")||e.endsWith(".avi")){var n=document.createElement("video");n.src=e,n.controls=!0,n.classList.add("img-fluid","mb-2"),n.style.maxWidth="300px",n.style.maxHeight="300px",t.appendChild(n)}else{var a=document.createElement("img");a.classList.add("img-fluid"),a.src=e,a.id="nav-media-img",a.style.width="10rem",a.style.height="10rem",t.appendChild(a)}}))})).catch((function(e){return console.error("Error:",e)})))},d.send(n)}window.location.href==="".concat(e,"/app/filemanagers")&&window.location.reload()})),console.log(window.location.href==="".concat(e,"/app/filemanagers")),$("#add_more_video").click((function(){var e=$(".video-inputs-container").first();e.find("select.select2").each((function(){$(this).data("select2")&&$(this).select2("destroy")}));var t=e.clone();i++,t.find("input, select").each((function(){var e=$(this).attr("id");e&&$(this).attr("id",e+i);var t=$(this).attr("name");t&&$(this).attr("name",t+i),$(this).val("").trigger("change")})),t.find(".remove-video-input").removeClass("d-none"),t.find("[data-image-container]").each((function(){var e=$(this).attr("data-image-container");$(this).attr("data-image-container",e+i)})),t.find("[data-hidden-input]").each((function(){var e=$(this).attr("data-hidden-input");$(this).attr("data-hidden-input",e+i)})),t.find(".img-fluid").remove(),t.find(".remove-media-icon").remove(),t.find('input[type="hidden"]').val(""),t.find("div[id]").each((function(){var e=$(this).attr("id");e&&$(this).attr("id",e+i)})),$("#video-inputs-container-parent").append(t),o(t),d()})),$(document).on("click",".remove-video-input",(function(){$(this).closest(".video-inputs-container").remove()})),d(),o($(document))})),document.getElementById("file_url_media")&&document.getElementById("file_url_media").addEventListener("change",(function(){var e=document.getElementById("file_url_media"),n=document.getElementById("uploadedImages"),a=31457280,i=[];if(n.innerHTML="",e.files.length>0)for(var d=0;d<e.files.length;d++){var r=e.files[d],o=Math.min(a,r.size);if(r.type.startsWith("video/")){var s=document.createElement("video");s.src=URL.createObjectURL(r),s.currentTime=1,s.addEventListener("loadeddata",(function(){var e=document.createElement("canvas");e.width=s.videoWidth,e.height=s.videoHeight,e.getContext("2d").drawImage(s,0,0,e.width,e.height);var d=document.createElement("img");d.src=e.toDataURL("image/jpeg"),d.classList.add("img-fluid","iq-uploaded-image"),d.style.width="150px",d.style.height="100px";var l=document.createElement("div");l.classList.add("progress","mb-3","iq-progress"),l.innerHTML='\n                            <div class="progress-bar" role="progressbar" style="width: 0%;" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100"></div>\n                        ';var c=document.createElement("div");c.classList.add("iq-uploaded-image-close"),c.innerHTML="&times;",c.addEventListener("click",(function(){i[0].removed=!0,this.parentNode.remove()}));var m=document.createElement("div");m.classList.add("iq-uploaded-image-container","d-flex","gap-5","align-items-center"),m.appendChild(d),m.appendChild(l),m.appendChild(c),n.appendChild(m),i.push({file:r,removed:!1,progressBar:l.querySelector(".progress-bar")}),t(r,0,0,o,a,i)}))}else{var l=new FileReader;l.onload=function(e,d){return function(r){var s=document.createElement("img");s.src=r.target.result,s.classList.add("img-fluid","iq-uploaded-image"),s.style.width="150px",s.style.height="100px";var l=document.createElement("div");l.classList.add("progress","mb-3","iq-progress"),l.innerHTML='\n                                <div class="progress-bar" role="progressbar" style="width: 0%;" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100"></div>\n                            ';var c=document.createElement("div");c.classList.add("iq-uploaded-image-close"),c.innerHTML="&times;",c.addEventListener("click",(function(){i[d].removed=!0,this.parentNode.remove()}));var m=document.createElement("div");m.classList.add("iq-uploaded-image-container","d-flex","gap-5","align-items-center"),m.appendChild(s),m.appendChild(l),m.appendChild(c),n.appendChild(m),i.push({file:e,removed:!1,progressBar:l.querySelector(".progress-bar")}),t(e,d,0,o,a,i)}}(r,d),l.readAsDataURL(r)}}window.uploadedFiles=i}))})();
//# sourceMappingURL=media.min.js.map